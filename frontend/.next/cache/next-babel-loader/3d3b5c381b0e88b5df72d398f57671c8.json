{"ast":null,"code":"var _jsxFileName = \"/Users/paulus/Desktop/automatch/hoc/withAuth.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../store/actions\";\nimport cookies from \"nookies\";\nimport Router from \"next/router\";\n\nconst authenticate = context => {\n  const {\n    access_token\n  } = cookies.get(context); // Checking if cookie is present\n  // if it is not present, redirect user to signin page\n\n  if (context.req && !access_token) {\n    console.log(\"ctx req ====> \", context);\n    context.res.writeHead(302, {\n      Location: \"/\"\n    });\n    context.res.end();\n    return;\n  }\n\n  if (!access_token) {\n    Router.push(\"/\");\n  }\n\n  return access_token;\n};\n\nconst isAuth = context => {\n  const {\n    access_token\n  } = cookies.get(context);\n  return access_token;\n};\n\nconst withAuth = WrappedComponent => {\n  return class extends Component {\n    static async getInitialProps(context) {\n      const access_token = authenticate(context);\n      const componentProps = WrappedComponent.getInitialProps && (await WrappedComponent.getInitialProps(context));\n      return _objectSpread({}, componentProps, {\n        access_token\n      });\n    }\n\n    render() {\n      return __jsx(WrappedComponent, _extends({}, this.props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 14\n        }\n      }));\n    }\n\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onGetUser: () => dispatch(actions.getUser())\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(withAuth);","map":{"version":3,"sources":["/Users/paulus/Desktop/automatch/hoc/withAuth.js"],"names":["Component","connect","actions","cookies","Router","authenticate","context","access_token","get","req","console","log","res","writeHead","Location","end","push","isAuth","withAuth","WrappedComponent","getInitialProps","componentProps","render","props","mapDispatchToProps","dispatch","onGetUser","getUser"],"mappings":";;;;;;;;;;;;AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,SAASC,OAAT,QAAwB,aAAxB;AAEA,OAAO,KAAKC,OAAZ,MAAyB,kBAAzB;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,OAAOC,MAAP,MAAmB,aAAnB;;AAEA,MAAMC,YAAY,GAAIC,OAAD,IAAa;AAChC,QAAM;AAAEC,IAAAA;AAAF,MAAmBJ,OAAO,CAACK,GAAR,CAAYF,OAAZ,CAAzB,CADgC,CAGhC;AACA;;AACA,MAAIA,OAAO,CAACG,GAAR,IAAe,CAACF,YAApB,EAAkC;AAChCG,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BL,OAA9B;AACAA,IAAAA,OAAO,CAACM,GAAR,CAAYC,SAAZ,CAAsB,GAAtB,EAA2B;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAA3B;AACAR,IAAAA,OAAO,CAACM,GAAR,CAAYG,GAAZ;AACA;AACD;;AAED,MAAI,CAACR,YAAL,EAAmB;AACjBH,IAAAA,MAAM,CAACY,IAAP,CAAY,GAAZ;AACD;;AAED,SAAOT,YAAP;AACD,CAjBD;;AAmBA,MAAMU,MAAM,GAAIX,OAAD,IAAa;AAC1B,QAAM;AAAEC,IAAAA;AAAF,MAAmBJ,OAAO,CAACK,GAAR,CAAYF,OAAZ,CAAzB;AACA,SAAOC,YAAP;AACD,CAHD;;AAKA,MAAMW,QAAQ,GAAIC,gBAAD,IAAsB;AACrC,SAAO,cAAcnB,SAAd,CAAwB;AAC7B,iBAAaoB,eAAb,CAA6Bd,OAA7B,EAAsC;AACpC,YAAMC,YAAY,GAAGF,YAAY,CAACC,OAAD,CAAjC;AAEA,YAAMe,cAAc,GAClBF,gBAAgB,CAACC,eAAjB,KACC,MAAMD,gBAAgB,CAACC,eAAjB,CAAiCd,OAAjC,CADP,CADF;AAIA,+BAAYe,cAAZ;AAA4Bd,QAAAA;AAA5B;AACD;;AAEDe,IAAAA,MAAM,GAAG;AACP,aAAO,MAAC,gBAAD,eAAsB,KAAKC,KAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAP;AACD;;AAb4B,GAA/B;AAeD,CAhBD;;AAkBA,MAAMC,kBAAkB,GAAIC,QAAD,IAAc;AACvC,SAAO;AACLC,IAAAA,SAAS,EAAE,MAAMD,QAAQ,CAACvB,OAAO,CAACyB,OAAR,EAAD;AADpB,GAAP;AAGD,CAJD;;AAMA,eAAe1B,OAAO,CAAC,IAAD,EAAOuB,kBAAP,CAAP,CAAkCN,QAAlC,CAAf","sourcesContent":["import { Component } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport * as actions from \"../store/actions\";\nimport cookies from \"nookies\";\nimport Router from \"next/router\";\n\nconst authenticate = (context) => {\n  const { access_token } = cookies.get(context);\n\n  // Checking if cookie is present\n  // if it is not present, redirect user to signin page\n  if (context.req && !access_token) {\n    console.log(\"ctx req ====> \", context);\n    context.res.writeHead(302, { Location: \"/\" });\n    context.res.end();\n    return;\n  }\n\n  if (!access_token) {\n    Router.push(\"/\");\n  }\n\n  return access_token;\n};\n\nconst isAuth = (context) => {\n  const { access_token } = cookies.get(context);\n  return access_token;\n};\n\nconst withAuth = (WrappedComponent) => {\n  return class extends Component {\n    static async getInitialProps(context) {\n      const access_token = authenticate(context);\n\n      const componentProps =\n        WrappedComponent.getInitialProps &&\n        (await WrappedComponent.getInitialProps(context));\n\n      return { ...componentProps, access_token };\n    }\n\n    render() {\n      return <WrappedComponent {...this.props} />;\n    }\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    onGetUser: () => dispatch(actions.getUser()),\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(withAuth);\n"]},"metadata":{},"sourceType":"module"}